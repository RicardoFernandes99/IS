{
  "Name": "ExtrairColocados_UIVision",
  "CreationDate": "2025-9-24",
  "Commands": [
    {
      "Command": "open",
      "Target": "https://dges.gov.pt/coloc/2025/col1listas.asp",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "educationType",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "${educationType} < 2",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${educationType} == 0",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "linkText=Ensino Superior Público Universitário",
      "Value": "",
      "Targets": [
        "linkText=Ensino Superior Público Universitário",
        "xpath=/html/body/div/table/tbody/tr/td/div[2]/table[2]/tbody/tr/td/ul/li/a",
        "xpath=//a",
        "css=body > div > table > tbody > tr > td > div:nth-child(5) > table:nth-child(4) > tbody > tr:nth-child(1) > td > ul > li > a"
      ],
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "linkText=Ensino Superior Público Politécnico",
      "Value": "",
      "Targets": [
        "linkText=Ensino Superior Público Politécnico",
        "xpath=/html/body/div/table/tbody/tr/td/div[2]/table[2]/tbody/tr/td/ul/li[2]/a",
        "xpath=//li[2]/a",
        "css=body > div > table > tbody > tr > td > div:nth-child(5) > table:nth-child(4) > tbody > tr:nth-child(1) > td > ul > li:nth-child(2) > a"
      ],
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr/td/select/option",
      "Value": "institutionCount",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "institutionIndex",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "${institutionIndex} < ${institutionCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr/td/select/option[${institutionIndex}+1]",
      "Value": "institutionName",
      "Description": ""
    },
    {
      "Command": "select",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr/td/select",
      "Value": "index=${institutionIndex}",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${institutionName}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "csvSave",
      "Target": "AlunosColocados.csv",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr[2]/td/input[4]",
      "Value": "",
      "Targets": [
        "name=listagem",
        "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr[2]/td/input[4]",
        "xpath=//input[@name='listagem' and @value='Lista de Colocados']",
        "xpath=//input[4]",
        "css=body > div > table > tbody > tr > td > div:nth-child(5) > form > table.caixa > tbody > tr:nth-child(2) > td > input:nth-child(4)"
      ],
      "Description": ""
    },
    {
      "Command": "waitForElementPresent",
      "Target": "name=CodCurso",
      "Value": "30000",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "i",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=//select[@name='CodCurso']/option",
      "Value": "courseCount",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "${i} < ${courseCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "select",
      "Target": "name=CodCurso",
      "Value": "index=${i}",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//select[@name='CodCurso']/option[${i}+1]",
      "Value": "currentCourse",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "name=search",
      "Value": "",
      "Targets": [
        "name=search",
        "xpath=/html/body/div/table/tbody/tr/td/div[2]/form/table[2]/tbody/tr[2]/td/input[3]",
        "xpath=//input[@name='search']",
        "xpath=//input[3]",
        "css=body > div > table > tbody > tr > td > div:nth-child(5) > form > table.caixa > tbody > tr:nth-child(2) > td > input:nth-child(3)"
      ],
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/table/tbody/tr[2]/td",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "csvSave",
      "Target": "AlunosColocados.csv",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/table[2]",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div/table/tbody/tr/td/div[2]/table[3]",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "csvSave",
      "Target": "AlunosColocados.csv",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "document.querySelector('a[href=\"javascript:voltar()\"]').click();",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${i}) + 1;",
      "Value": "i",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "linkText=Voltar",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${institutionIndex}) + 1;",
      "Value": "institutionIndex",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "linkText=Voltar",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${educationType}) + 1;",
      "Value": "educationType",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    }
  ]
}